# Default Configurations for a Quicklook Pipeline setup for a dark science exposure
name: DESI Quicklook Dark Survey
Program: dark
Flavor: science
#- Writeout intermediate files
WritePreprocfile: True
#- Debuglevel 
Debuglevel: 20
#- Heartbeat Period in seconds
Period: 5.0
#- Time out in seconds
Timeout: 120.0
# Pipeline algorithm: PAs and QAs for each PA
Pipeline: [Initialize, Preproc, Flexure, BoxcarExtract, ApplyFiberFlat_QL, SkySub_QL]
Algorithms:
    Initialize:
        QA: 
            Check_HDUs:
                PARAMS: {}
    Preproc:
        QA: 
            Bias_From_Overscan:
                PARAMS: {BIAS_AMP_NORMAL_RANGE: [-20.0, 20.0], BIAS_AMP_WARN_RANGE: [-50.0, 50.0], BIAS_AMP_REF:[176.0,179.0,114.0,174.0]}
            Get_RMS:
                PARAMS: {PERCENTILES: [68.2,95.4,99.7], NOISE_AMP_NORMAL_RANGE: [-1.0, 1.0], NOISE_AMP_WARN_RANGE: [-2.0, 2.0],NOISE_AMP_REF:[2.1,2.2,2.1,2.0]}
            Count_Pixels:
                PARAMS: {CUTPIX: 5, LITFRAC_AMP_NORMAL_RANGE: [-0.1, 0.1], LITFRAC_AMP_WARN_RANGE: [-0.2, 0.2],LITFRAC_AMP_REF:[0.3,0.3,0.4,0.4]}
            Calc_XWSigma:
                PARAMS: {B_PEAKS: [5578.9],
                         R_PEAKS: [6301.9],
                         Z_PEAKS: [9378.5],
                         PIXEL_RANGE: 7,
                         XWSIGMA_NORMAL_RANGE: [-2.0, 2.0],
                         XWSIGMA_WARN_RANGE: [-4.0, 4.0],XWSIGMA_REF:[1.1,1.8]}
    Flexure:
        QA:
            Trace_Shifts:
                PARAMS: {XYSHIFTS_NORMAL_RANGE: [-1.0,1.0], XYSHIFTS_WARN_RANGE: [-2.0,2.0],XYSHIFTS_REF:[0.,0.]}
    BoxcarExtract:
        wavelength: {
            b: [3570,5730,0.8],
            r: [5630,7740,0.8],
            z: [7650,9830,0.8]
            }
        QuickResolution: True
        QA: 
            CountSpectralBins:
                PARAMS: {CUTBINS: 5, N_KNOWN_BROKEN_FIBERS: 0, NGOODFIB_NORMAL_RANGE: [-1., 1.], NGOODFIB_WARN_RANGE: [-2., 2.],NGOODFIB_REF:[500]}
    ApplyFiberFlat_QL:
        QA:
            Sky_Continuum:
                PARAMS: {B_CONT: ["4000, 4500", "5250, 5550"],
                         R_CONT: ["5950, 6200", "6990, 7230"],
                         Z_CONT: ["8120, 8270", "9110, 9280"],
                         SKYCONT_NORMAL_RANGE: [-10.0, 10.0],
                         SKYCONT_WARN_RANGE: [-20.0, 20.0],SKYCONT_REF:[160]}
            Sky_Peaks:
                PARAMS: {B_PEAKS: [3914.4, 5199.3, 5201.8],
                         R_PEAKS: [6301.9, 6365.4, 7318.2, 7342.8, 7371.3],
                         Z_PEAKS: [8401.5, 8432.4, 8467.5, 9479.4, 9505.6, 9521.8],
                         PEAKCOUNT_NORMAL_RANGE: [-1.0, 1.0],
                         PEAKCOUNT_WARN_RANGE: [-2.0, 2.0],PEAKCOUNT_REF:[4.0]}
    SkySub_QL:
        QA: 
            Sky_Rband:
                PARAMS: {B_CONT: ["4000, 4500", "5250, 5550"],
                         R_CONT: ["5950, 6200", "6990, 7230"],
                         Z_CONT: ["8120, 8270", "9110, 9280"],
                         SKYRBAND_NORMAL_RANGE: [-1.0, 1.0],
                         SKYRBAND_WARN_RANGE: [-2.0, 2.0], SKYRBAND_REF:[100.]}
            Integrate_Spec:
                PARAMS: {DELTAMAG_TGT_NORMAL_RANGE: [-2., 2.0], DELTAMAG_TGT_WARN_RANGE: [-4., 4.],DELTAMAG_TGT_REF:[4.0,4.0,3.0,3.0]}
            Calculate_SNR:
                #- First two entries set boundaries for SNR residual values via absolute vales or sigmas
                PARAMS: {RESIDUAL_CUT: 0.2, SIGMA_CUT: 2.0, FIDSNR_TGT_NORMAL_RANGE: [-11., 11.], FIDSNR_TGT_WARN_RANGE: [-12., 12.], FIDSNR_TGT_REF:[2.,4.,5.,6.], FIDMAG: 22.}
